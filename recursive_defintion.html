<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recursive Definition</title>
    <style>
        body {
            background-color: #f5f5f5;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        .generate-btn {
            display: block;
            margin: 0 auto 30px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .generate-btn:hover {
            background-color: #45a049;
        }

        .problem {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            height: 720px;
            /* 10 inches at 72 DPI */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .problem-number {
            font-weight: bold;
            font-size: 11px;
            margin-bottom: 15px;
        }

        .problem-directions {
            font-weight: bold;
            font-size: 15px;
            margin-bottom: 15px;
        }

        .problem-area {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .graph-container {
            margin-right: 15px;
        }

        .graph {
            width: 300px;
            height: 300px;
            border: 1px solid #333;
        }

        .multiple-choice {
            font-size: 12px;
            margin-top: 15px;
        }

        .choice {
            height: 80px;
            /* margin-bottom: 8px; */
        }

        /* from piecewise function div */
        .piecewise-container {
            background: white;
            padding: 5px;
            border-radius: 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 10px;
            height: 50px;
        }

        .function-name {
            font-weight: bold;
            font-style: italic;
        }

        .brace-container {
            display: flex;
            align-items: stretch;
            height: 30px;
            width: 20px;

        }

        .brace {
            font-size: 30px;
            line-height: 1;
            display: flex;
            align-items: center;
            color: #333;
            transform: scaleX(0.3);
            /* transform-origin: left center; */
            padding-bottom: 10px;
        }

        .expressions {
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            height: 10px;
            transform: translateY(-20px);
            /* Adjust -10px for the desired upward movement */

        }

        .expression-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 3px 0;
        }

        .math-expression {
            font-weight: normal;
        }

        .inequality {
            font-weight: normal;
            color: #666;
        }

        .comma {
            margin-right: 10px;
        }

        /* Styling for mathematical elements */
        .coefficient {
            /* font-style: italic; */
        }

        .variable {
            font-style: italic;
        }

        .constant {
            font-weight: normal;
        }

        .point {
            fill: #2563eb;
        }

        .open-point {
            fill: white;
            stroke: #2563eb;
            stroke-width: 2;
        }

        .problem-area .math-definition {
            font-family: 'Times New Roman', serif;
            font-size: 18px;
            line-height: 2;
            padding: 20px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            max-width: 600px;
            /* margin: 20px auto; */
        }

        .problem-area .math {
            font-style: italic;
            color: #2c3e50;
        }

        .problem-area .math .number {
            font-style: normal;
            font-weight: normal;
        }

        .problem-area .english {
            font-style: normal;
            color: #34495e;
            margin: 0 8px;
        }

        .problem-area .definition-line {
            margin-bottom: 12px;
        }

        .problem-area .definition-line:last-child {
            margin-bottom: 0;
        }

        .problem-area sub {
            font-size: 0.8em;
            vertical-align: sub;
        }

        .problem-area sup {
            font-size: 0.8em;
            vertical-align: super;
        }

        /* From Mathematical Notation in HTML/CSS from Claude */
        /* .problem-area .math-container {
            font-family: 'Times New Roman', serif;
            font-size: 18px;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
        } */

        .problem-area.math {
            font-style: italic;
            display: inline-block;
        }

        .problem-area.english {
            font-style: normal;
            font-weight: normal;
        }

        .problem-area .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
            margin: 0 4px;
        }

        .problem-area .numerator {
            display: block;
            border-bottom: 2px solid black;
            padding-bottom: 2px;
            margin-bottom: 2px;
        }

        .problem-area .denominator {
            display: block;
            padding-top: 2px;
        }

        .problem-area .superscript {
            font-size: 0.7em;
            vertical-align: super;
            line-height: 0;
        }

        .problem-area .number {
            font-style: normal;
        }

        /* 
        Choices Area
         */

         .choice .math-definition {
            font-family: 'Times New Roman', serif;
            font-size: 14px;
            line-height: 1;
            padding: 20px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            /* max-width is problem specific */
            max-width: 50px; 
            /* margin: 10px; */
            /* margin: 20px auto; */
        }

        .choice .math {
            font-style: italic;
            color: #2c3e50;
        }

        .choice .math .number {
            font-style: normal;
            font-weight: normal;
        }

        .choice .english {
            font-style: normal;
            color: #34495e;
            margin: 0 8px;
        }

        .choice .definition-line {
            margin-bottom: 12px;
        }

        .choice .definition-line:last-child {
            margin-bottom: 0;
        }

        .choice sub {
            font-size: 0.8em;
            vertical-align: sub;
        }

        .choice sup {
            font-size: 0.8em;
            vertical-align: super;
        }

        .choice .math {
            font-style: italic;
            display: inline-block;
        }

        .choice .english {
            font-style: normal;
            font-weight: normal;
        }

        .choice .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
            margin: 0 4px;
        }

        .choice .numerator {
            display: block;
            border-bottom: 2px solid black;
            padding-bottom: 2px;
            margin-bottom: 2px;
        }

        .choice .denominator {
            display: block;
            padding-top: 2px;
        }

        .choice .superscript {
            font-size: 0.7em;
            vertical-align: super;
            line-height: 0;
        }

        .choice .number {
            font-style: normal;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Recursive Definition</h1>
        <button class="generate-btn" onclick="generateProblems()">Generate Problems</button>
        <div id="problems-container"></div>
    </div>

    <script>
        function generateProblems() {
            const container = document.getElementById('problems-container');
            container.innerHTML = '';

            for (let i = 1; i <= 10; i++) {
                const problem = generateProblem(i);
                container.appendChild(problem);
            }
        }

        function generateProblem(problemNumber) {
            const problemDiv = document.createElement('div');
            problemDiv.className = 'problem';
            /**
             * Each type of problem problem is unique but may have similar sets of variables
             */


            a_1 = Math.ceil(Math.random() * 9);
            d = Math.ceil(Math.random() * 9);

            const correctAnswer = {
                a_1: a_1,
                d: d
            };


            // Create problem content
            problemDiv.innerHTML = `
                <div class="problem-number">Problem ${problemNumber}</div>
                <div class="problem-directions">
                    Given the following recursive defintion:
                </div>
                <div class="problem-area">
                    <div class="math-definition">
                        <div class="definition-line">
                            <span class="math">
                                <span class="math">a</span><sub class="math">n</sub> = <span class="number">${a_1}</span>
                            </span>
                            <span class="english">when</span>
                            <span class="math">
                                <span class="math">n</span> = <span class="number">1</span>
                            </span>
                        </div>

                        <div class="definition-line">
                            <span class="math">
                                <span class="math">a</span><sub class="math">n</sub> = <span class="math">a</span><sub
                                    class="math">n</sub><sub>-<span class="number">1</span></sub> + <span class="number">${d}</span>
                            </span>
                            <span class="english">when</span>
                            <span class="math">
                                <span class="math">n</span> > <span class="number">1</span>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="problem-directions">
                    What is the explicit defintiion of the sequence?
                </div>
                <div class="multiple-choice">
                    ${generateChoices(correctAnswer)}
                </div>
            `;

            return problemDiv;
        }

        function formatFunction(a, c) {
            let functionStr = '';

            if (a === 1) {
                functionStr = 'x²';
            } else {
                functionStr = `${a}x²`;
            }

            if (c > 0) {
                functionStr += ` + ${c}`;
            } else if (c < 0) {
                functionStr += ` - ${Math.abs(c)}`;
            }

            return functionStr;
        }

        // Draw graph - parameters will be end points of // UPDATE
        function drawGraph(width, height, orderedPairs, inequalities) {
            let svg = '';
            const DOMAIN = 22
            const RANGE = 22
            const CENTER_X = width / 2;
            const CENTER_Y = height / 2;

            // Grid lines
            for (let i = 0; i <= DOMAIN; i++) {
                const x = i * width / DOMAIN;
                svg += `<line x1="${x}" y1="0" x2="${x}" y2="300" stroke="#e0e0e0" stroke-width="0.5"/>`;

            }
            for (let i = 0; i <= RANGE; i++) {

                const y = i * 300 / RANGE;
                svg += `<line x1="0" y1="${y}" x2="${width}" y2="${y}" stroke="#e0e0e0" stroke-width="0.5"/>`;
            }

            // Axes
            svg += `<line x1="${CENTER_X}" y1="0" x2="${CENTER_X}" y2="300" stroke="#333" stroke-width="1"/>`;
            svg += `<line x1="0" y1="${CENTER_Y}" x2="${width}" y2="${CENTER_Y}" stroke="#333" stroke-width="1"/>`;

            // FUTURE - change every 5 intervals to a variable.
            // Axis labels (every 5 intervals)
            for (let i = 0; i <= DOMAIN; i += 5) {
                const pixel = i * width / DOMAIN + 13;
                const value = i - DOMAIN / 2 + 1;
                if (value !== 0) {

                    svg += `<text x="${pixel}" y="145" text-anchor="middle" font-size="8">${value}</text>`;
                    // svg += `<text x="155" y="${pixel + 3}" text-anchor="middle" font-size="8">${11 - i}</text>`;
                }
            }
            for (let i = 0; i <= DOMAIN; i += 5) {
                const pixel = i * width / DOMAIN + 13;
                const value = i - DOMAIN / 2 + 1;
                if (value !== 0) {

                    // svg += `<text x="${pixel}" y="145" text-anchor="middle" font-size="8">${value}</text>`;
                    svg += `<text x="155" y="${pixel + 3}" text-anchor="middle" font-size="8">${10 - i}</text>`;
                }
            }

            // Draw Line exmamples
            // svg += `<line x1="100" y1="330" x2="340" y2="330" stroke="blue" stroke-width="2"/>` 
            // svg += `<line x1="${CENTER_X + orderedPairs[0][0] * width / DOMAIN}" y1="${CENTER_Y - orderedPairs[0][1] * height / RANGE}" x2="${CENTER_X + orderedPairs[1][0] * width / DOMAIN}" y2="${CENTER_Y - orderedPairs[0][1] * height / RANGE}" stroke="#00f" stroke-width="2.1"/>`;
            // svg += `<line x1="${CENTER_X + orderedPairs[1][0] * width / DOMAIN}" y1="${CENTER_Y - orderedPairs[1][1] * height / RANGE}" x2="${CENTER_X + orderedPairs[2][0] * width / DOMAIN}" y2="${CENTER_Y - orderedPairs[2][1] * height / RANGE}" stroke="#00f" stroke-width="2.1"/>`;
            // svg += `<line x1="${CENTER_X + orderedPairs[3][0] * width / DOMAIN}" y1="${CENTER_Y - orderedPairs[3][1] * height / RANGE}" x2="${CENTER_X + orderedPairs[4][0] * width / DOMAIN}" y2="${CENTER_Y - orderedPairs[4][1] * height / RANGE}" stroke="#00f" stroke-width="2.1"/>`;



            return svg;
        }

        // function generateChoices() {
        function generateChoices(correctAnswer) {
            const choices = [correctAnswer];
            // console.log(correctAnswer);

            // Generate 3 incorrect answers
            while (choices.length < 4) {
                const incorrect = {
                    a_1: correctAnswer.a_1 + (Math.random() < 0.5 ? -1: 1) * Math.ceil(Math.random() * 3),
                    d: correctAnswer.d + (Math.random() < 0.5 ? -1: 1) * Math.ceil(Math.random() * 3)
                };
                choices.push(incorrect);
            }

            // Shuffle choices
            for (let i = choices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [choices[i], choices[j]] = [choices[j], choices[i]];
            }

            // Generate HTML for each choice
            let choicesHTML = '';
            const letters = ['A', 'B', 'C', 'D'];

            choices.forEach((choice, index) => {
                const formattedChoice = formatChoice(choice);
                choicesHTML += `<div class="choice">${letters[index]}. ${formattedChoice}</div>`;
            });

            return choicesHTML;
        }

        function formatChoice(value) {
            // a_1 + d(n -1)
            // dn + a_1 - d
            return `
            <div class="math-definition">
                <div class="definition-line">
                    <span class="math"><span class="number">${value.d}</span>n</span> ${(value.a_1 - value.d) < 0 ? "-" : "+"} <span class="number">${Math.abs(value.a_1 - value.d)}</span>
                </div>            
            </div>
            `
        }

        // Generate initial problems
        generateProblems();
    </script>
</body>

</html>
